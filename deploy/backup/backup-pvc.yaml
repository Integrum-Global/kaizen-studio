apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: backup-pvc
  namespace: kaizen-studio
  labels:
    app: kaizen-studio
    component: backup
spec:
  # Access mode: ReadWriteOnce (single node) or ReadWriteMany (multi-node)
  accessModes:
  - ReadWriteOnce

  # Storage class (update based on your cluster)
  # Common storage classes:
  # - gp3, gp2 (AWS EBS)
  # - standard, premium-rwo (GCP Persistent Disk)
  # - managed-premium (Azure Disk)
  # - local-path (Local storage)
  storageClassName: gp3  # Update this for your environment

  # Storage size
  resources:
    requests:
      storage: 100Gi  # Adjust based on backup size requirements

  # Volume mode
  volumeMode: Filesystem

---
# Optional: PersistentVolume for local storage
# apiVersion: v1
# kind: PersistentVolume
# metadata:
#   name: backup-pv
#   labels:
#     app: kaizen-studio
#     component: backup
# spec:
#   capacity:
#     storage: 100Gi
#   volumeMode: Filesystem
#   accessModes:
#   - ReadWriteOnce
#   persistentVolumeReclaimPolicy: Retain
#   storageClassName: local-storage
#   local:
#     path: /mnt/backup
#   nodeAffinity:
#     required:
#       nodeSelectorTerms:
#       - matchExpressions:
#         - key: kubernetes.io/hostname
#           operator: In
#           values:
#           - node-name  # Update with your node name

---
# Storage size recommendations:
# - Development: 10-20Gi
# - Staging: 50-100Gi
# - Production: 100Gi+ (based on database size and retention policy)
#
# Calculation:
# backup_size = database_size * compression_ratio (typically 0.3-0.7)
# total_storage = backup_size * retention_count * 1.2 (20% buffer)
#
# Example:
# - Database: 10GB
# - Compression: 50% (5GB per backup)
# - Retention: 10 backups
# - Total: 5GB * 10 * 1.2 = 60GB (round up to 100GB)
